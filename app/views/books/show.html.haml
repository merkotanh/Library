.row
  .col-12
    #book-title-section
      = @book.title
    #book-author-section
      = @book.author
.row
  .col-6
    = render "ratings/setrating"
  .col-6
    #takebook-section
      - if @book.taken_by?(current_user.id) == 0
        / book is busy
        .book-n-aval
          Book is being read
        %small
          = link_to "by #{@book.taken_by.email}", user_path(@book.taken_by.id)
      - else
        / book's free
        = link_to "#{@book.taken_by?(current_user.id) == -1 ? 'Return' : 'Take' }", toggle_enable_status_book_path(@book),  id: "bookid", method: :put, remote: true, class: "btn btn-xs btn-#{@book.taken_by?(current_user.id) == -1 ? 'warning' : 'success'}"
.row
  .col-5
    #book-img-section
      = image_tag @book.image_url(:small), class: "book-img-section"
  .col-7
    .special-text
      = @book.description
    .btn.expand-description
      read more

- if current_user.admin
  = link_to 'Edit', edit_book_path(@book)
  = link_to 'Destroy', @book, method: :delete, data: { confirm: 'Are you sure?' }
= link_to 'Back', books_path

#comments-count
  = "#{@book.comments.all.size} comments"

#comments-section
  = render @book.comments
- if @book.comments.all.size > 2
  .btn.expand-comments
    read more

= form_for [ @book, @book.comments.build ], remote: true  do |form|
  = form.text_area :content, class: "form-control"
  = form.submit class: "btn btn-light"

#history-section
  = render @book.histories
- if @book.histories.all.size > 4
  .btn.expand-history 
    read more

:javascript
  $('.expand-description').on('click', function(){
    $('.special-text').toggleClass('-expanded');
    
    if ($('.special-text').hasClass('-expanded')) {
      $('.expand-description').html('hide content');
    } else {
      $('.expand-description').html('read more');
    }
  });

  $('.expand-history').on('click', function(){
    $('#history-section').toggleClass('-expanded');
    
    if ($('#history-section').hasClass('-expanded')) {
      $('.expand-history').html('hide content');
    } else {
      $('.expand-history').html('read more');
    }
  });

  $('.expand-comments').on('click', function(){
    $('#comments-section').toggleClass('-expanded');
    
    if ($('#comments-section').hasClass('-expanded')) {
      $('.expand-comments').html('hide content');
    } else {
      $('.expand-comments').html('read more');
    }
  });